"use strict";const version=2,canvas=document.querySelector("#glcanvas");var clipboard=null,plugins=[],high_dpi=!1,blocking_event_loop=!1;function init_webgl(version){if(version==1){gl=canvas.getContext("webgl");function acquireVertexArrayObjectExtension(ctx){var ext=ctx.getExtension("OES_vertex_array_object");ext?(ctx.createVertexArray=function(){return ext.createVertexArrayOES()},ctx.deleteVertexArray=function(vao){ext.deleteVertexArrayOES(vao)},ctx.bindVertexArray=function(vao){ext.bindVertexArrayOES(vao)},ctx.isVertexArray=function(vao){return ext.isVertexArrayOES(vao)}):alert("Unable to get OES_vertex_array_object extension")}function acquireInstancedArraysExtension(ctx){var ext=ctx.getExtension("ANGLE_instanced_arrays");ext&&(ctx.vertexAttribDivisor=function(index,divisor){ext.vertexAttribDivisorANGLE(index,divisor)},ctx.drawArraysInstanced=function(mode,first,count,primcount){ext.drawArraysInstancedANGLE(mode,first,count,primcount)},ctx.drawElementsInstanced=function(mode,count,type,indices,primcount){ext.drawElementsInstancedANGLE(mode,count,type,indices,primcount)})}function acquireDisjointTimerQueryExtension(ctx){var ext=ctx.getExtension("EXT_disjoint_timer_query");ext&&(ctx.createQuery=function(){return ext.createQueryEXT()},ctx.beginQuery=function(target,query){return ext.beginQueryEXT(target,query)},ctx.endQuery=function(target){return ext.endQueryEXT(target)},ctx.deleteQuery=function(query){ext.deleteQueryEXT(query)},ctx.getQueryObject=function(query,pname){return ext.getQueryObjectEXT(query,pname)})}function acquireDrawBuffers(ctx){var ext=ctx.getExtension("WEBGL_draw_buffers");ext&&(ctx.drawBuffers=function(bufs){return ext.drawBuffersWEBGL(bufs)})}try{gl.getExtension("EXT_shader_texture_lod"),gl.getExtension("OES_standard_derivatives")}catch(e){console.warn(e)}acquireVertexArrayObjectExtension(gl),acquireInstancedArraysExtension(gl),acquireDisjointTimerQueryExtension(gl),acquireDrawBuffers(gl),gl.getExtension("WEBGL_depth_texture")==null&&alert("Cant initialize WEBGL_depth_texture extension")}else gl=canvas.getContext("webgl2");gl===null&&alert("Unable to initialize WebGL. Your browser or machine may not support it.")}canvas.focus(),canvas.requestPointerLock=canvas.requestPointerLock||canvas.mozRequestPointerLock||function(){},document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||function(){};function assert(flag,message){flag==!1&&alert(message)}function getArray(ptr,arr,n){return new arr(wasm_memory.buffer,ptr,n)}function UTF8ToString(ptr,maxBytesToRead){let u8Array=new Uint8Array(wasm_memory.buffer,ptr);for(var u0,u1,u2,ch,idx=0,endIdx=idx+maxBytesToRead,str="";!(idx>=endIdx);){if(u0=u8Array[idx++],!u0)return str;if(!(u0&128)){str+=String.fromCharCode(u0);continue}if(u1=u8Array[idx++]&63,(u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue}u2=u8Array[idx++]&63,(u0&240)==224?u0=(u0&15)<<12|u1<<6|u2:((u0&248)!=240&&console.warn("Invalid UTF-8 leading byte 0x"+u0.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),u0=(u0&7)<<18|u1<<12|u2<<6|u8Array[idx++]&63),u0<65536?str+=String.fromCharCode(u0):(ch=u0-65536,str+=String.fromCharCode(55296|ch>>10,56320|ch&1023))}return str}function stringToUTF8(str,heap,outIdx,maxBytesToWrite){for(var u,u1,startIdx=outIdx,endIdx=outIdx+maxBytesToWrite,i=0;i<str.length;++i)if(u=str.charCodeAt(i),u>=55296&&u<=57343&&(u1=str.charCodeAt(++i),u=65536+((u&1023)<<10)|u1&1023),u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6,heap[outIdx++]=128|u&63}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12,heap[outIdx++]=128|u>>6&63,heap[outIdx++]=128|u&63}else{if(outIdx+3>=endIdx)break;u>=2097152&&console.warn("Invalid Unicode code point 0x"+u.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),heap[outIdx++]=240|u>>18,heap[outIdx++]=128|u>>12&63,heap[outIdx++]=128|u>>6&63,heap[outIdx++]=128|u&63}return outIdx-startIdx}FS={loaded_files:[],unique_id:0},GL={counter:1,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],timerQueries:[],contexts:{},programInfos:{},getNewId:function(table){for(var ret=GL.counter++,i=table.length;i<ret;i++)table[i]=null;return ret},validateGLObjectID:function(objectHandleArray,objectID,callerFunctionName,objectReadableType){objectID!=0&&(objectHandleArray[objectID]===null?console.error(callerFunctionName+" called with an already deleted "+objectReadableType+" ID "+objectID+"!"):objectHandleArray[objectID]||console.error(callerFunctionName+" called with an invalid "+objectReadableType+" ID "+objectID+"!"))},getSource:function(shader,count,string,length){for(var len,source="",i=0;i<count;++i)len=length==0?void 0:getArray(length+i*4,Uint32Array,1)[0],source+=UTF8ToString(getArray(string+i*4,Uint32Array,1)[0],len);return source},populateUniformTable:function(program){GL.validateGLObjectID(GL.programs,program,"populateUniformTable","program");for(var loc,id,n,j,p=GL.programs[program],ptable=GL.programInfos[program]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},utable=ptable.uniforms,numUniforms=gl.getProgramParameter(p,35718),i=0;i<numUniforms;++i){var u=gl.getActiveUniform(p,i),name=u.name;if(ptable.maxUniformLength=Math.max(ptable.maxUniformLength,name.length+1),name.slice(-1)=="]"&&(name=name.slice(0,name.lastIndexOf("["))),loc=gl.getUniformLocation(p,name),loc){id=GL.getNewId(GL.uniforms),utable[name]=[u.size,id],GL.uniforms[id]=loc;for(j=1;j<u.size;++j)n=name+"["+j+"]",loc=gl.getUniformLocation(p,n),id=GL.getNewId(GL.uniforms),GL.uniforms[id]=loc}}}};function _glGenObject(n,buffers,createFunction,objectTable,functionName){for(i=0;i<n;i++){var i,buffer=gl[createFunction](),id=buffer&&GL.getNewId(objectTable);buffer?(buffer.name=id,objectTable[id]=buffer):(console.error("GL_INVALID_OPERATION"),GL.recordError(1282),alert("GL_INVALID_OPERATION in "+functionName+": GLctx."+createFunction+" returned null - most likely GL context is lost!")),getArray(buffers+i*4,Int32Array,1)[0]=id}}function _webglGet(name_,p,type){if(!p){console.error("GL_INVALID_VALUE in glGet"+type+"v(name="+name_+": Function called with null out pointer!"),GL.recordError(1281);return}switch(ret=void 0,name_){case 36346:ret=1;break;case 36344:type!="EM_FUNC_SIG_PARAM_I"&&type!="EM_FUNC_SIG_PARAM_I64"&&(GL.recordError(1280),err("GL_INVALID_ENUM in glGet"+type+"v(GL_SHADER_BINARY_FORMATS): Invalid parameter type!"));return;case 34814:case 36345:ret=0;break;case 34466:var ret,i,formats=gl.getParameter(34467);ret=formats?formats.length:0;break;case 33309:assert(!1,"unimplemented");break;case 33307:case 33308:assert(!1,"unimplemented");break}if(ret===void 0){var result=gl.getParameter(name_);switch(typeof result){case"number":ret=result;break;case"boolean":ret=result?1:0;break;case"string":GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+type+"v("+name_+") on a name which returns a string!");return;case"object":if(result===null)switch(name_){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 35097:case 36389:case 34068:{ret=0;break}default:{GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+type+"v("+name_+") and it returns null!");return}}else if(result instanceof Float32Array||result instanceof Uint32Array||result instanceof Int32Array||result instanceof Array){for(i=0;i<result.length;++i)assert(!1,"unimplemented");return}else try{ret=result.name|0}catch(e){GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+type+"v: Unknown object returned from WebGL getParameter("+name_+")! (error: "+e+")");return}break;default:GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+type+"v: Native code calling glGet"+type+"v("+name_+") and it returns "+result+" of type "+typeof result+"!");return}}switch(type){case"EM_FUNC_SIG_PARAM_I64":getArray(p,Int32Array,1)[0]=ret;case"EM_FUNC_SIG_PARAM_I":getArray(p,Int32Array,1)[0]=ret;break;case"EM_FUNC_SIG_PARAM_F":getArray(p,Float32Array,1)[0]=ret;break;case"EM_FUNC_SIG_PARAM_B":getArray(p,Int8Array,1)[0]=ret?1:0;break;default:throw"internal glGet error, bad type: "+type}}function resize(canvas,on_resize){var dpr=dpi_scale(),displayWidth=canvas.clientWidth*dpr,displayHeight=canvas.clientHeight*dpr;(canvas.width!=displayWidth||canvas.height!=displayHeight)&&(canvas.width=displayWidth,canvas.height=displayHeight,on_resize!=null&&on_resize(Math.floor(displayWidth),Math.floor(displayHeight)))}function animation(){wasm_exports.frame(),window.blocking_event_loop||(animation_frame_timeout&&window.cancelAnimationFrame(animation_frame_timeout),animation_frame_timeout=window.requestAnimationFrame(animation))}const SAPP_EVENTTYPE_TOUCHES_BEGAN=10,SAPP_EVENTTYPE_TOUCHES_MOVED=11,SAPP_EVENTTYPE_TOUCHES_ENDED=12,SAPP_EVENTTYPE_TOUCHES_CANCELED=13,SAPP_MODIFIER_SHIFT=1,SAPP_MODIFIER_CTRL=2,SAPP_MODIFIER_ALT=4,SAPP_MODIFIER_SUPER=8;function into_sapp_mousebutton(btn){switch(btn){case 0:return 0;case 1:return 2;case 2:return 1;default:return btn}}function into_sapp_keycode(key_code){switch(key_code){case"Space":return 32;case"Quote":return 222;case"Comma":return 44;case"Minus":return 45;case"Period":return 46;case"Slash":return 189;case"Digit0":return 48;case"Digit1":return 49;case"Digit2":return 50;case"Digit3":return 51;case"Digit4":return 52;case"Digit5":return 53;case"Digit6":return 54;case"Digit7":return 55;case"Digit8":return 56;case"Digit9":return 57;case"Semicolon":return 59;case"Equal":return 61;case"KeyA":return 65;case"KeyB":return 66;case"KeyC":return 67;case"KeyD":return 68;case"KeyE":return 69;case"KeyF":return 70;case"KeyG":return 71;case"KeyH":return 72;case"KeyI":return 73;case"KeyJ":return 74;case"KeyK":return 75;case"KeyL":return 76;case"KeyM":return 77;case"KeyN":return 78;case"KeyO":return 79;case"KeyP":return 80;case"KeyQ":return 81;case"KeyR":return 82;case"KeyS":return 83;case"KeyT":return 84;case"KeyU":return 85;case"KeyV":return 86;case"KeyW":return 87;case"KeyX":return 88;case"KeyY":return 89;case"KeyZ":return 90;case"BracketLeft":return 91;case"Backslash":return 92;case"BracketRight":return 93;case"Backquote":return 96;case"Escape":return 256;case"Enter":return 257;case"Tab":return 258;case"Backspace":return 259;case"Insert":return 260;case"Delete":return 261;case"ArrowRight":return 262;case"ArrowLeft":return 263;case"ArrowDown":return 264;case"ArrowUp":return 265;case"PageUp":return 266;case"PageDown":return 267;case"Home":return 268;case"End":return 269;case"CapsLock":return 280;case"ScrollLock":return 281;case"NumLock":return 282;case"PrintScreen":return 283;case"Pause":return 284;case"F1":return 290;case"F2":return 291;case"F3":return 292;case"F4":return 293;case"F5":return 294;case"F6":return 295;case"F7":return 296;case"F8":return 297;case"F9":return 298;case"F10":return 299;case"F11":return 300;case"F12":return 301;case"F13":return 302;case"F14":return 303;case"F15":return 304;case"F16":return 305;case"F17":return 306;case"F18":return 307;case"F19":return 308;case"F20":return 309;case"F21":return 310;case"F22":return 311;case"F23":return 312;case"F24":return 313;case"Numpad0":return 320;case"Numpad1":return 321;case"Numpad2":return 322;case"Numpad3":return 323;case"Numpad4":return 324;case"Numpad5":return 325;case"Numpad6":return 326;case"Numpad7":return 327;case"Numpad8":return 328;case"Numpad9":return 329;case"NumpadDecimal":return 330;case"NumpadDivide":return 331;case"NumpadMultiply":return 332;case"NumpadSubtract":return 333;case"NumpadAdd":return 334;case"NumpadEnter":return 335;case"NumpadEqual":return 336;case"ShiftLeft":return 340;case"ControlLeft":return 341;case"AltLeft":return 342;case"OSLeft":return 343;case"ShiftRight":return 344;case"ControlRight":return 345;case"AltRight":return 346;case"OSRight":return 347;case"ContextMenu":return 348}console.log("Unsupported keyboard key: ",key_code)}function dpi_scale(){return high_dpi?window.devicePixelRatio||1:1}function texture_size(internalFormat,width,height){return internalFormat==gl.ALPHA?width*height:internalFormat==gl.RGB?width*height*3:internalFormat==gl.RGBA?width*height*4:width*height*3}function mouse_relative_position(clientX,clientY){var targetRect=canvas.getBoundingClientRect(),x=(clientX-targetRect.left)*dpi_scale(),y=(clientY-targetRect.top)*dpi_scale();return{x,y}}var gl,wasm_memory,animation_frame_timeout,FS,GL,Module,wasm_exports,quad_socket,emscripten_shaders_hack=!1,importObject={env:{console_debug:function(ptr){console.debug(UTF8ToString(ptr))},console_log:function(ptr){console.log(UTF8ToString(ptr))},console_info:function(ptr){console.info(UTF8ToString(ptr))},console_warn:function(ptr){console.warn(UTF8ToString(ptr))},console_error:function(ptr){console.error(UTF8ToString(ptr))},set_emscripten_shader_hack:function(flag){emscripten_shaders_hack=flag},sapp_set_clipboard:function(ptr,len){clipboard=UTF8ToString(ptr,len)},dpi_scale,rand:function(){return Math.floor(Math.random()*2147483647)},now:function(){return Date.now()/1e3},canvas_width:function(){return Math.floor(canvas.width)},canvas_height:function(){return Math.floor(canvas.height)},glClearDepthf:function(depth){gl.clearDepth(depth)},glClearColor:function(r,g,b,a){gl.clearColor(r,g,b,a)},glClearStencil:function(s){gl.clearStencil(s)},glColorMask:function(red,green,blue,alpha){gl.colorMask(red,green,blue,alpha)},glScissor:function(x,y,w,h){gl.scissor(x,y,w,h)},glClear:function(mask){gl.clear(mask)},glGenTextures:function(n,textures){_glGenObject(n,textures,"createTexture",GL.textures,"glGenTextures")},glActiveTexture:function(texture){gl.activeTexture(texture)},glBindTexture:function(target,texture){GL.validateGLObjectID(GL.textures,texture,"glBindTexture","texture"),gl.bindTexture(target,GL.textures[texture])},glTexImage2D:function(target,level,internalFormat,width,height,border,format,type,pixels){gl.texImage2D(target,level,internalFormat,width,height,border,format,type,pixels?getArray(pixels,Uint8Array,texture_size(internalFormat,width,height)):null)},glTexSubImage2D:function(target,level,xoffset,yoffset,width,height,format,type,pixels){gl.texSubImage2D(target,level,xoffset,yoffset,width,height,format,type,pixels?getArray(pixels,Uint8Array,texture_size(format,width,height)):null)},glReadPixels:function(x,y,width,height,format,type,pixels){var pixelData=getArray(pixels,Uint8Array,texture_size(format,width,height));gl.readPixels(x,y,width,height,format,type,pixelData)},glTexParameteri:function(target,pname,param){gl.texParameteri(target,pname,param)},glUniform1fv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform1fv","location"),assert((value&3)==0,"Pointer to float data passed to glUniform1fv must be aligned to four bytes!");var view=getArray(value,Float32Array,1*count);gl.uniform1fv(GL.uniforms[location],view)},glUniform2fv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform2fv","location"),assert((value&3)==0,"Pointer to float data passed to glUniform2fv must be aligned to four bytes!");var view=getArray(value,Float32Array,2*count);gl.uniform2fv(GL.uniforms[location],view)},glUniform3fv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform3fv","location"),assert((value&3)==0,"Pointer to float data passed to glUniform3fv must be aligned to four bytes!");var view=getArray(value,Float32Array,3*count);gl.uniform3fv(GL.uniforms[location],view)},glUniform4fv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform4fv","location"),assert((value&3)==0,"Pointer to float data passed to glUniform4fv must be aligned to four bytes!");var view=getArray(value,Float32Array,4*count);gl.uniform4fv(GL.uniforms[location],view)},glUniform1iv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform1fv","location"),assert((value&3)==0,"Pointer to i32 data passed to glUniform1iv must be aligned to four bytes!");var view=getArray(value,Int32Array,1*count);gl.uniform1iv(GL.uniforms[location],view)},glUniform2iv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform2fv","location"),assert((value&3)==0,"Pointer to i32 data passed to glUniform2iv must be aligned to four bytes!");var view=getArray(value,Int32Array,2*count);gl.uniform2iv(GL.uniforms[location],view)},glUniform3iv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform3fv","location"),assert((value&3)==0,"Pointer to i32 data passed to glUniform3iv must be aligned to four bytes!");var view=getArray(value,Int32Array,3*count);gl.uniform3iv(GL.uniforms[location],view)},glUniform4iv:function(location,count,value){GL.validateGLObjectID(GL.uniforms,location,"glUniform4fv","location"),assert((value&3)==0,"Pointer to i32 data passed to glUniform4iv must be aligned to four bytes!");var view=getArray(value,Int32Array,4*count);gl.uniform4iv(GL.uniforms[location],view)},glBlendFunc:function(sfactor,dfactor){gl.blendFunc(sfactor,dfactor)},glBlendEquationSeparate:function(modeRGB,modeAlpha){gl.blendEquationSeparate(modeRGB,modeAlpha)},glDisable:function(cap){gl.disable(cap)},glDrawElements:function(mode,count,type,indices){gl.drawElements(mode,count,type,indices)},glGetIntegerv:function(name_,p){_webglGet(name_,p,"EM_FUNC_SIG_PARAM_I")},glUniform1f:function(location,v0){GL.validateGLObjectID(GL.uniforms,location,"glUniform1f","location"),gl.uniform1f(GL.uniforms[location],v0)},glUniform1i:function(location,v0){GL.validateGLObjectID(GL.uniforms,location,"glUniform1i","location"),gl.uniform1i(GL.uniforms[location],v0)},glGetAttribLocation:function(program,name){return gl.getAttribLocation(GL.programs[program],UTF8ToString(name))},glEnableVertexAttribArray:function(index){gl.enableVertexAttribArray(index)},glDisableVertexAttribArray:function(index){gl.disableVertexAttribArray(index)},glVertexAttribPointer:function(index,size,type,normalized,stride,ptr){gl.vertexAttribPointer(index,size,type,!!normalized,stride,ptr)},glVertexAttribIPointer:function(index,size,type,stride,ptr){gl.vertexAttribIPointer(index,size,type,stride,ptr)},glGetUniformLocation:function(program,name){GL.validateGLObjectID(GL.programs,program,"glGetUniformLocation","program"),name=UTF8ToString(name);var arrayIndex=0;if(name[name.length-1]=="]"){var leftBrace=name.lastIndexOf("[");arrayIndex=name[leftBrace+1]!="]"?parseInt(name.slice(leftBrace+1)):0,name=name.slice(0,leftBrace)}var uniformInfo=GL.programInfos[program]&&GL.programInfos[program].uniforms[name];return uniformInfo&&arrayIndex>=0&&arrayIndex<uniformInfo[0]?uniformInfo[1]+arrayIndex:-1},glUniformMatrix4fv:function(location,count,transpose,value){GL.validateGLObjectID(GL.uniforms,location,"glUniformMatrix4fv","location"),assert((value&3)==0,"Pointer to float data passed to glUniformMatrix4fv must be aligned to four bytes!");var view=getArray(value,Float32Array,16);gl.uniformMatrix4fv(GL.uniforms[location],!!transpose,view)},glUseProgram:function(program){GL.validateGLObjectID(GL.programs,program,"glUseProgram","program"),gl.useProgram(GL.programs[program])},glGenVertexArrays:function(n,arrays){_glGenObject(n,arrays,"createVertexArray",GL.vaos,"glGenVertexArrays")},glGenFramebuffers:function(n,ids){_glGenObject(n,ids,"createFramebuffer",GL.framebuffers,"glGenFramebuffers")},glBindVertexArray:function(vao){gl.bindVertexArray(GL.vaos[vao])},glBindFramebuffer:function(target,framebuffer){GL.validateGLObjectID(GL.framebuffers,framebuffer,"glBindFramebuffer","framebuffer"),gl.bindFramebuffer(target,GL.framebuffers[framebuffer])},glGenBuffers:function(n,buffers){_glGenObject(n,buffers,"createBuffer",GL.buffers,"glGenBuffers")},glBindBuffer:function(target,buffer){GL.validateGLObjectID(GL.buffers,buffer,"glBindBuffer","buffer"),gl.bindBuffer(target,GL.buffers[buffer])},glBufferData:function(target,size,data,usage){gl.bufferData(target,data?getArray(data,Uint8Array,size):size,usage)},glBufferSubData:function(target,offset,size,data){gl.bufferSubData(target,offset,data?getArray(data,Uint8Array,size):size)},glEnable:function(cap){gl.enable(cap)},glFlush:function(){gl.flush()},glFinish:function(){gl.finish()},glDepthFunc:function(func){gl.depthFunc(func)},glBlendFuncSeparate:function(sfactorRGB,dfactorRGB,sfactorAlpha,dfactorAlpha){gl.blendFuncSeparate(sfactorRGB,dfactorRGB,sfactorAlpha,dfactorAlpha)},glViewport:function(x,y,width,height){gl.viewport(x,y,width,height)},glDrawArrays:function(mode,first,count){gl.drawArrays(mode,first,count)},glDrawBuffers:function(n,bufs){gl.drawBuffers(getArray(bufs,Int32Array,n))},glCreateProgram:function(){var id=GL.getNewId(GL.programs),program=gl.createProgram();return program.name=id,GL.programs[id]=program,id},glAttachShader:function(program,shader){GL.validateGLObjectID(GL.programs,program,"glAttachShader","program"),GL.validateGLObjectID(GL.shaders,shader,"glAttachShader","shader"),gl.attachShader(GL.programs[program],GL.shaders[shader])},glDetachShader:function(program,shader){GL.validateGLObjectID(GL.programs,program,"glDetachShader","program"),GL.validateGLObjectID(GL.shaders,shader,"glDetachShader","shader"),gl.detachShader(GL.programs[program],GL.shaders[shader])},glLinkProgram:function(program){GL.validateGLObjectID(GL.programs,program,"glLinkProgram","program"),gl.linkProgram(GL.programs[program]),GL.populateUniformTable(program)},glPixelStorei:function(pname,param){gl.pixelStorei(pname,param)},glFramebufferTexture2D:function(target,attachment,textarget,texture,level){GL.validateGLObjectID(GL.textures,texture,"glFramebufferTexture2D","texture"),gl.framebufferTexture2D(target,attachment,textarget,GL.textures[texture],level)},glGetProgramiv:function(program,pname,p){if(assert(p),GL.validateGLObjectID(GL.programs,program,"glGetProgramiv","program"),program>=GL.counter){console.error("GL_INVALID_VALUE in glGetProgramiv");return}var log,ptable=GL.programInfos[program];if(!ptable){console.error("GL_INVALID_OPERATION in glGetProgramiv(program="+program+", pname="+pname+", p=0x"+p.toString(16)+"): The specified GL object name does not refer to a program object!");return}if(pname==35716)log=gl.getProgramInfoLog(GL.programs[program]),assert(log!==null),getArray(p,Int32Array,1)[0]=log.length+1;else if(pname==35719){console.error("unsupported operation");return}else if(pname==35722){console.error("unsupported operation");return}else if(pname==35381){console.error("unsupported operation");return}else getArray(p,Int32Array,1)[0]=gl.getProgramParameter(GL.programs[program],pname)},glCreateShader:function(shaderType){var id=GL.getNewId(GL.shaders);return GL.shaders[id]=gl.createShader(shaderType),id},glStencilFuncSeparate:function(face,func,ref_,mask){gl.stencilFuncSeparate(face,func,ref_,mask)},glStencilMaskSeparate:function(face,mask){gl.stencilMaskSeparate(face,mask)},glStencilOpSeparate:function(face,fail,zfail,zpass){gl.stencilOpSeparate(face,fail,zfail,zpass)},glFrontFace:function(mode){gl.frontFace(mode)},glCullFace:function(mode){gl.cullFace(mode)},glCopyTexImage2D:function(target,level,internalformat,x,y,width,height,border){gl.copyTexImage2D(target,level,internalformat,x,y,width,height,border)},glShaderSource:function(shader,count,string,length){GL.validateGLObjectID(GL.shaders,shader,"glShaderSource","shader");var source=GL.getSource(shader,count,string,length);if(emscripten_shaders_hack){source=source.replace(/#extension GL_OES_standard_derivatives : enable/g,""),source=source.replace(/#extension GL_EXT_shader_texture_lod : enable/g,"");var prelude="";source.indexOf("gl_FragColor")!=-1&&(prelude+=`out mediump vec4 GL_FragColor;
`,source=source.replace(/gl_FragColor/g,"GL_FragColor")),source.indexOf("attribute")!=-1?(source=source.replace(/attribute/g,"in"),source=source.replace(/varying/g,"out")):source=source.replace(/varying/g,"in"),source=source.replace(/textureCubeLodEXT/g,"textureCubeLod"),source=source.replace(/texture2DLodEXT/g,"texture2DLod"),source=source.replace(/texture2DProjLodEXT/g,"texture2DProjLod"),source=source.replace(/texture2DGradEXT/g,"texture2DGrad"),source=source.replace(/texture2DProjGradEXT/g,"texture2DProjGrad"),source=source.replace(/textureCubeGradEXT/g,"textureCubeGrad"),source=source.replace(/textureCube/g,"texture"),source=source.replace(/texture1D/g,"texture"),source=source.replace(/texture2D/g,"texture"),source=source.replace(/texture3D/g,"texture"),source=source.replace(/#version 100/g,`#version 300 es
`+prelude)}gl.shaderSource(GL.shaders[shader],source)},glGetProgramInfoLog:function(program,maxLength,length,infoLog){GL.validateGLObjectID(GL.programs,program,"glGetProgramInfoLog","program");var i,log=gl.getProgramInfoLog(GL.programs[program]);assert(log!==null);let array=getArray(infoLog,Uint8Array,maxLength);for(i=0;i<maxLength;i++)array[i]=log.charCodeAt(i)},glGetString:function(id){var parameter=gl.getParameter(id).toString(),len=parameter.length+1,msg=wasm_exports.allocate_vec_u8(len),array=new Uint8Array(wasm_memory.buffer,msg,len);return array[parameter.length]=0,stringToUTF8(parameter,array,0,len),msg},glCompileShader:function(shader){GL.validateGLObjectID(GL.shaders,shader,"glCompileShader","shader"),gl.compileShader(GL.shaders[shader])},glGetShaderiv:function(shader,pname,p){if(assert(p),GL.validateGLObjectID(GL.shaders,shader,"glGetShaderiv","shader"),pname==35716)log=gl.getShaderInfoLog(GL.shaders[shader]),assert(log!==null),getArray(p,Int32Array,1)[0]=log.length+1;else if(pname==35720){var log,source=gl.getShaderSource(GL.shaders[shader]),sourceLength=source===null||source.length==0?0:source.length+1;getArray(p,Int32Array,1)[0]=sourceLength}else getArray(p,Int32Array,1)[0]=gl.getShaderParameter(GL.shaders[shader],pname)},glGetShaderInfoLog:function(shader,maxLength,length,infoLog){GL.validateGLObjectID(GL.shaders,shader,"glGetShaderInfoLog","shader");var i,log=gl.getShaderInfoLog(GL.shaders[shader]);assert(log!==null);let array=getArray(infoLog,Uint8Array,maxLength);for(i=0;i<maxLength;i++)array[i]=log.charCodeAt(i)},glVertexAttribDivisor:function(index,divisor){gl.vertexAttribDivisor(index,divisor)},glDrawArraysInstanced:function(mode,first,count,primcount){gl.drawArraysInstanced(mode,first,count,primcount)},glDrawElementsInstanced:function(mode,count,type,indices,primcount){gl.drawElementsInstanced(mode,count,type,indices,primcount)},glDeleteShader:function(shader){var id=GL.shaders[shader];if(id==null)return;gl.deleteShader(id),GL.shaders[shader]=null},glDeleteProgram:function(program){var id=GL.programs[program];if(id==null)return;gl.deleteProgram(id),GL.programs[program]=null},glDeleteBuffers:function(n,buffers){for(i=0;i<n;i++){var i,id=getArray(buffers+i*4,Uint32Array,1)[0],buffer=GL.buffers[id];if(!buffer)continue;gl.deleteBuffer(buffer),buffer.name=0,GL.buffers[id]=null}},glDeleteFramebuffers:function(n,buffers){for(i=0;i<n;i++){var i,id=getArray(buffers+i*4,Uint32Array,1)[0],buffer=GL.framebuffers[id];if(!buffer)continue;gl.deleteFramebuffer(buffer),buffer.name=0,GL.framebuffers[id]=null}},glDeleteTextures:function(n,textures){for(i=0;i<n;i++){var i,id=getArray(textures+i*4,Uint32Array,1)[0],texture=GL.textures[id];if(!texture)continue;gl.deleteTexture(texture),texture.name=0,GL.textures[id]=null}},glGenQueries:function(n,ids){_glGenObject(n,ids,"createQuery",GL.timerQueries,"glGenQueries")},glDeleteQueries:function(n){for(i=0;i<n;i++){var i,id=getArray(textures+i*4,Uint32Array,1)[0],query=GL.timerQueries[id];if(!query)continue;gl.deleteQuery(query),query.name=0,GL.timerQueries[id]=null}},glBeginQuery:function(target,id){GL.validateGLObjectID(GL.timerQueries,id,"glBeginQuery","id"),gl.beginQuery(target,GL.timerQueries[id])},glEndQuery:function(target){gl.endQuery(target)},glGetQueryObjectiv:function(id,pname,ptr){GL.validateGLObjectID(GL.timerQueries,id,"glGetQueryObjectiv","id");let result=gl.getQueryObject(GL.timerQueries[id],pname);getArray(ptr,Uint32Array,1)[0]=result},glGetQueryObjectui64v:function(id,pname,ptr){GL.validateGLObjectID(GL.timerQueries,id,"glGetQueryObjectui64v","id");let result=gl.getQueryObject(GL.timerQueries[id],pname),heap=getArray(ptr,Uint32Array,2);heap[0]=result,heap[1]=(result-heap[0])/4294967296},glGenerateMipmap:function(index){gl.generateMipmap(index)},setup_canvas_size:function(high_dpi){window.high_dpi=high_dpi,resize(canvas)},run_animation_loop:function(blocking){canvas.onmousemove=function(event){var relative_position=mouse_relative_position(event.clientX,event.clientY),x=relative_position.x,y=relative_position.y;wasm_exports.mouse_move(Math.floor(x),Math.floor(y)),(event.movementX!=0||event.movementY!=0)&&wasm_exports.raw_mouse_move(Math.floor(event.movementX),Math.floor(event.movementY))},canvas.onmousedown=function(event){var relative_position=mouse_relative_position(event.clientX,event.clientY),x=relative_position.x,y=relative_position.y,btn=into_sapp_mousebutton(event.button);wasm_exports.mouse_down(x,y,btn)},canvas.addEventListener("wheel",function(event){event.preventDefault(),wasm_exports.mouse_wheel(-event.deltaX,-event.deltaY)}),canvas.onmouseup=function(event){var relative_position=mouse_relative_position(event.clientX,event.clientY),x=relative_position.x,y=relative_position.y,btn=into_sapp_mousebutton(event.button);wasm_exports.mouse_up(x,y,btn)},canvas.onkeydown=function(event){var sapp_key_code=into_sapp_keycode(event.code);switch(sapp_key_code){case 32:case 262:case 263:case 264:case 265:case 290:case 291:case 292:case 293:case 294:case 295:case 296:case 297:case 298:case 299:case 259:case 258:case 39:case 47:event.preventDefault();break}var modifiers=0;event.ctrlKey&&(modifiers|=SAPP_MODIFIER_CTRL),event.shiftKey&&(modifiers|=SAPP_MODIFIER_SHIFT),event.altKey&&(modifiers|=SAPP_MODIFIER_ALT),wasm_exports.key_down(sapp_key_code,modifiers,event.repeat),(sapp_key_code==32||sapp_key_code==39||sapp_key_code==47)&&wasm_exports.key_press(sapp_key_code)},canvas.onkeyup=function(event){var sapp_key_code=into_sapp_keycode(event.code),modifiers=0;event.ctrlKey&&(modifiers|=SAPP_MODIFIER_CTRL),event.shiftKey&&(modifiers|=SAPP_MODIFIER_SHIFT),event.altKey&&(modifiers|=SAPP_MODIFIER_ALT),wasm_exports.key_up(sapp_key_code,modifiers)},canvas.onkeypress=function(event){var sapp_key_code=into_sapp_keycode(event.code);let chrome_only=sapp_key_code==261||event.ctrlKey;chrome_only==!1&&wasm_exports.key_press(event.charCode)},canvas.addEventListener("touchstart",function(event){event.preventDefault();for(const touch of event.changedTouches){let relative_position=mouse_relative_position(touch.clientX,touch.clientY);wasm_exports.touch(SAPP_EVENTTYPE_TOUCHES_BEGAN,touch.identifier,relative_position.x,relative_position.y)}}),canvas.addEventListener("touchend",function(event){event.preventDefault();for(const touch of event.changedTouches){let relative_position=mouse_relative_position(touch.clientX,touch.clientY);wasm_exports.touch(SAPP_EVENTTYPE_TOUCHES_ENDED,touch.identifier,relative_position.x,relative_position.y)}}),canvas.addEventListener("touchcancel",function(event){event.preventDefault();for(const touch of event.changedTouches){let relative_position=mouse_relative_position(touch.clientX,touch.clientY);wasm_exports.touch(SAPP_EVENTTYPE_TOUCHES_CANCELED,touch.identifier,relative_position.x,relative_position.y)}}),canvas.addEventListener("touchmove",function(event){event.preventDefault();for(const touch of event.changedTouches){let relative_position=mouse_relative_position(touch.clientX,touch.clientY);wasm_exports.touch(SAPP_EVENTTYPE_TOUCHES_MOVED,touch.identifier,relative_position.x,relative_position.y)}}),window.onresize=function(){resize(canvas,wasm_exports.resize)},window.addEventListener("copy",function(){clipboard!=null&&(event.clipboardData.setData("text/plain",clipboard),event.preventDefault())}),window.addEventListener("cut",function(){clipboard!=null&&(event.clipboardData.setData("text/plain",clipboard),event.preventDefault())}),window.addEventListener("paste",function(e){e.stopPropagation(),e.preventDefault();var clipboardData=e.clipboardData||window.clipboardData,pastedData=clipboardData.getData("Text");if(pastedData!=null&&pastedData.length!=0){var len=(new TextEncoder).encode(pastedData).length,msg=wasm_exports.allocate_vec_u8(len),heap=new Uint8Array(wasm_memory.buffer,msg,len);stringToUTF8(pastedData,heap,0,len),wasm_exports.on_clipboard_paste(msg,len)}}),window.ondragover=function(e){e.preventDefault()},window.ondrop=async function(e){e.preventDefault(),wasm_exports.on_files_dropped_start();for(let file of e.dataTransfer.files){const nameLen=file.name.length,nameVec=wasm_exports.allocate_vec_u8(nameLen),nameHeap=new Uint8Array(wasm_memory.buffer,nameVec,nameLen);stringToUTF8(file.name,nameHeap,0,nameLen);const fileBuf=await file.arrayBuffer(),fileLen=fileBuf.byteLength,fileVec=wasm_exports.allocate_vec_u8(fileLen),fileHeap=new Uint8Array(wasm_memory.buffer,fileVec,fileLen);fileHeap.set(new Uint8Array(fileBuf),0),wasm_exports.on_file_dropped(nameVec,nameLen,fileVec,fileLen)}wasm_exports.on_files_dropped_finish()};let lastFocus=document.hasFocus();var checkFocus=function(){let hasFocus=document.hasFocus();lastFocus==hasFocus&&(wasm_exports.focus(hasFocus),lastFocus=hasFocus)};document.addEventListener("visibilitychange",checkFocus),window.addEventListener("focus",checkFocus),window.addEventListener("blur",checkFocus),window.blocking_event_loop=blocking,window.requestAnimationFrame(animation)},fs_load_file:function(ptr,len){var xhr,url=UTF8ToString(ptr,len),file_id=FS.unique_id;return FS.unique_id+=1,xhr=new XMLHttpRequest,xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.onreadystatechange=function(){if(this.readyState===4)if(this.status===200){var uInt8Array=new Uint8Array(this.response);FS.loaded_files[file_id]=uInt8Array,wasm_exports.file_loaded(file_id)}else FS.loaded_files[file_id]=null,wasm_exports.file_loaded(file_id)},xhr.send(),file_id},fs_get_buffer_size:function(file_id){return FS.loaded_files[file_id]==null?-1:FS.loaded_files[file_id].length},fs_take_buffer:function(file_id,ptr,max_length){var file=FS.loaded_files[file_id];console.assert(file.length<=max_length);for(var dest=new Uint8Array(wasm_memory.buffer,ptr,max_length),i=0;i<file.length;i++)dest[i]=file[i];delete FS.loaded_files[file_id]},sapp_set_cursor_grab:function(grab){grab?canvas.requestPointerLock():document.exitPointerLock()},sapp_set_cursor:function(ptr,len){canvas.style.cursor=UTF8ToString(ptr,len)},sapp_is_fullscreen:function(){let fullscreenElement=document.fullscreenElement;return fullscreenElement!=null&&fullscreenElement.id==canvas.id},sapp_set_fullscreen:function(fullscreen){fullscreen?canvas.requestFullscreen():document.exitFullscreen()},sapp_set_window_size:function(new_width,new_height){canvas.width=new_width,canvas.height=new_height,resize(canvas,wasm_exports.resize)},sapp_schedule_update:function(){animation_frame_timeout&&window.cancelAnimationFrame(animation_frame_timeout),animation_frame_timeout=window.requestAnimationFrame(animation)},init_webgl}};function register_plugins(plugins){if(plugins==null)return;for(var i=0;i<plugins.length;i++)plugins[i].register_plugin!=void 0&&plugins[i].register_plugin!=null&&plugins[i].register_plugin(importObject)}function init_plugins(plugins){if(plugins==null)return;for(i=0;i<plugins.length;i++)if(plugins[i].on_init!=void 0&&plugins[i].on_init!=null&&plugins[i].on_init(),plugins[i].name==void 0||plugins[i].name==null||plugins[i].version==void 0||plugins[i].version==null)console.warn("Some of the registred plugins do not have name or version"),console.warn("Probably old version of the plugin used");else{var version_func=plugins[i].name+"_crate_version";if(wasm_exports[version_func]==void 0)console.log("Plugin "+plugins[i].name+" is present in JS bundle, but is not used in the rust code.");else{var i,crate_version=wasm_exports[version_func]();plugins[i].version!=crate_version&&console.error("Plugin "+plugins[i].name+" version mismatchjs version: "+plugins[i].version+", crate version: "+crate_version)}}}function miniquad_add_plugin(plugin){plugins.push(plugin)}function add_missing_functions_stabs(obj){var imports=WebAssembly.Module.imports(obj);for(const i in imports)importObject.env[imports[i].name]==void 0&&(console.warn("No "+imports[i].name+" function in gl.js"),importObject.env[imports[i].name]=function(){console.warn("Missed function: "+imports[i].name)})}function load(wasm_path){var req=fetch(wasm_path);register_plugins(plugins),typeof WebAssembly.compileStreaming=="function"?WebAssembly.compileStreaming(req).then(obj=>(add_missing_functions_stabs(obj),WebAssembly.instantiate(obj,importObject))).then(obj=>{wasm_memory=obj.exports.memory,wasm_exports=obj.exports;var crate_version=wasm_exports.crate_version();version!=crate_version&&console.error("Version mismatch: gl.js version is: "+version+", miniquad crate version is: "+crate_version),init_plugins(plugins),obj.exports.main()}).catch(err=>{console.error(err)}):req.then(function(x){return x.arrayBuffer()}).then(function(bytes){return WebAssembly.compile(bytes)}).then(function(obj){return add_missing_functions_stabs(obj),WebAssembly.instantiate(obj,importObject)}).then(function(obj){wasm_memory=obj.exports.memory,wasm_exports=obj.exports;var crate_version=wasm_exports.crate_version();version!=crate_version&&console.error("Version mismatch: gl.js version is: "+version+", rust sapp-wasm crate version is: "+crate_version),init_plugins(plugins),obj.exports.main()}).catch(err=>{console.error("WASM failed to load, probably incompatible gl.js version"),console.error(err)})}"use strict";const AudioContext=window.AudioContext||window.webkitAudioContext;let audio_context,sounds=new Map,playbacks=[],sound_key_next=1,playback_key_next=1;function audio_init(){if(audio_context==null){audio_context=new AudioContext;let audio_listener=audio_context.listener;{let AudioContext=window.AudioContext||window.webkitAudioContext,ctx=new AudioContext;var fixAudioContext=function(){console.log("fix"),audio_context.resume();var buffer=ctx.createBuffer(1,1,22050),source=ctx.createBufferSource();source.buffer=buffer,source.connect(ctx.destination),source.start?source.start(0):source.play?source.play(0):source.noteOn&&source.noteOn(0),document.removeEventListener("touchstart",fixAudioContext),document.removeEventListener("touchend",fixAudioContext),document.removeEventListener("mousedown",fixAudioContext),document.removeEventListener("keydown",fixAudioContext)};document.addEventListener("touchstart",fixAudioContext),document.addEventListener("touchend",fixAudioContext),document.addEventListener("mousedown",fixAudioContext),document.addEventListener("keydown",fixAudioContext)}}}function audio_add_buffer(content,content_len){let content_array=wasm_memory.buffer.slice(content,content+content_len),sound_key=sound_key_next;return sound_key_next+=1,audio_context.decodeAudioData(content_array,function(buffer){sounds.set(sound_key,buffer)},function(e){console.error("Failed to decode audio buffer",e)}),sound_key}function audio_source_is_loaded(sound_key){return sounds.has(sound_key)&&sounds.get(sound_key)!=void 0}function recycle_playback(){let playback=playbacks.find(playback=>playback.sound_key===0);return playback!=null?playback.source=audio_context.createBufferSource():(playback={sound_key:0,playback_key:0,source:audio_context.createBufferSource(),gain_node:audio_context.createGain(),ended:null},playbacks.push(playback)),playback}function stop(playback){try{playback.source.removeEventListener("ended",playback.ended),playback.source.disconnect(),playback.gain_node.disconnect(),playback.sound_key=0,playback.playback_key=0}catch(e){console.error("Error stopping sound",e)}}function audio_play_buffer(sound_key,volume,repeat){let playback_key=playback_key_next++,pb=recycle_playback();pb.sound_key=sound_key,pb.playback_key=playback_key,pb.source.connect(pb.gain_node),pb.gain_node.connect(audio_context.destination),pb.gain_node.gain.value=volume,pb.source.loop=repeat,pb.ended=function(){stop(pb)},pb.source.addEventListener("ended",pb.ended);try{pb.source.buffer=sounds.get(sound_key),pb.source.start(0)}catch(e){console.error("Error starting sound",e)}return playback_key}function audio_source_set_volume(sound_key,volume){playbacks.forEach(playback=>{playback.sound_key===sound_key&&(playback.gain_node.gain.value=volume)})}function audio_source_stop(sound_key){playbacks.forEach(playback=>{playback.sound_key===sound_key&&stop(playback)})}function audio_source_delete(sound_key){audio_source_stop(sound_key),sounds.delete(sound_key)}function audio_playback_stop(playback_key){let playback=playbacks.find(playback=>playback.playback_key===playback_key);playback!=null&&stop(playback)}function audio_playback_set_volume(playback_key,volume){let playback=playbacks.find(playback=>playback.playback_key===playback_key);playback!=null&&(playback.gain_node.gain.value=volume)}function register_plugin(importObject){importObject.env.audio_init=audio_init,importObject.env.audio_add_buffer=audio_add_buffer,importObject.env.audio_play_buffer=audio_play_buffer,importObject.env.audio_source_is_loaded=audio_source_is_loaded,importObject.env.audio_source_set_volume=audio_source_set_volume,importObject.env.audio_source_stop=audio_source_stop,importObject.env.audio_source_delete=audio_source_delete,importObject.env.audio_playback_stop=audio_playback_stop,importObject.env.audio_playback_set_volume=audio_playback_set_volume}miniquad_add_plugin({register_plugin,version:1,name:"macroquad_audio"}),"use strict";var ctx=null,js_objects={};js_objects[-1]=null,js_objects[-2]=void 0;var unique_js_id=0;function register_plugin(importObject){importObject.env.js_create_string=function(buf,max_len){var string=UTF8ToString(buf,max_len);return js_object(string)},importObject.env.js_create_buffer=function(buf,max_len){var src=new Uint8Array(wasm_memory.buffer,buf,max_len),new_buffer=new Uint8Array(new ArrayBuffer(src.byteLength));return new_buffer.set(new Uint8Array(src)),js_object(new_buffer)},importObject.env.js_create_object=function(){var object={};return js_object(object)},importObject.env.js_set_field_f32=function(obj_id,buf,max_len,data){var field=UTF8ToString(buf,max_len);js_objects[obj_id][field]=data},importObject.env.js_set_field_u32=function(obj_id,buf,max_len,data){var field=UTF8ToString(buf,max_len);js_objects[obj_id][field]=data},importObject.env.js_set_field_string=function(obj_id,buf,max_len,data_buf,data_len){var field=UTF8ToString(buf,max_len),data=UTF8ToString(data_buf,data_len);js_objects[obj_id][field]=data},importObject.env.js_unwrap_to_str=function(obj_id,buf,max_len){for(var str=js_objects[obj_id],utf8array=toUTF8Array(str),length=utf8array.length,dest=new Uint8Array(wasm_memory.buffer,buf,max_len),i=0;i<length;i++)dest[i]=utf8array[i]},importObject.env.js_unwrap_to_buf=function(obj_id,buf,max_len){for(var src=js_objects[obj_id],length=src.length,dest=new Uint8Array(wasm_memory.buffer,buf,max_len),i=0;i<length;i++)dest[i]=src[i]},importObject.env.js_string_length=function(obj_id){var str=js_objects[obj_id];return toUTF8Array(str).length},importObject.env.js_buf_length=function(obj_id){var buf=js_objects[obj_id];return buf.length},importObject.env.js_free_object=function(obj_id){delete js_objects[obj_id]},importObject.env.js_have_field=function(obj_id,buf,length){var field_name=UTF8ToString(buf,length);return js_objects[obj_id][field_name]!==void 0},importObject.env.js_field_f32=function(obj_id,buf,length){var field_name=UTF8ToString(buf,length);return js_objects[obj_id][field_name]},importObject.env.js_field_u32=function(obj_id,buf,length){var field_name=UTF8ToString(buf,length);return js_objects[obj_id][field_name]},importObject.env.js_field=function(obj_id,buf,length){var field_name=UTF8ToString(buf,length),field=js_objects[obj_id][field_name];return js_object(field)},importObject.env.js_field_num=function(js_object,buf,length){var field_name=UTF8ToString(buf,length);return js_objects[js_object][field_name]}}miniquad_add_plugin({register_plugin,version:"0.1.5",name:"sapp_jsutils"});function toUTF8Array(str){for(var utf8=[],i=0;i<str.length;i++){var charcode=str.charCodeAt(i);charcode<128?utf8.push(charcode):charcode<2048?utf8.push(192|charcode>>6,128|charcode&63):charcode<55296||charcode>=57344?utf8.push(224|charcode>>12,128|charcode>>6&63,128|charcode&63):(i++,charcode=65536+((charcode&1023)<<10|str.charCodeAt(i)&1023),utf8.push(240|charcode>>18,128|charcode>>12&63,128|charcode>>6&63,128|charcode&63))}return utf8}function js_object(obj){if(obj==null)return-2;if(obj===null)return-1;var id=unique_js_id;return js_objects[id]=obj,unique_js_id+=1,id}function consume_js_object(id){var object=js_objects[id];return delete js_objects[id],object}function get_js_object(id){return js_objects[id]}function on_init(){}register_plugin=function(importObject){importObject.env.ws_connect=ws_connect,importObject.env.ws_is_connected=ws_is_connected,importObject.env.ws_send=ws_send,importObject.env.ws_try_recv=ws_try_recv,importObject.env.http_make_request=http_make_request,importObject.env.http_try_recv=http_try_recv},miniquad_add_plugin({register_plugin,on_init,version:"0.1.1",name:"quad_net"});var connected=0,received_buffer=[];function ws_is_connected(){return connected}function ws_connect(addr){quad_socket=new WebSocket(consume_js_object(addr)),quad_socket.binaryType="arraybuffer",quad_socket.onopen=function(){connected=1},quad_socket.onmessage=function(msg){if(typeof msg.data=="string")received_buffer.push({text:1,data:msg.data});else{var buffer=new Uint8Array(msg.data);received_buffer.push({text:0,data:buffer})}}}function ws_send(data){var array=consume_js_object(data);array.buffer!=void 0?quad_socket.send(array.buffer):quad_socket.send(array)}function ws_try_recv(){return received_buffer.length!=0?js_object(received_buffer.shift()):-1}var uid=0,ongoing_requests={};function http_try_recv(cid){if(ongoing_requests[cid]!=void 0&&ongoing_requests[cid]!=null){var data=ongoing_requests[cid];return ongoing_requests[cid]=null,js_object(data)}return-1}function http_make_request(scheme,url,body,headers){cid=uid,uid+=1,scheme==0&&(scheme_string="POST"),scheme==1&&(scheme_string="PUT"),scheme==2&&(scheme_string="GET"),scheme==3&&(scheme_string="DELETE");var cid,scheme_string,url_string=consume_js_object(url),body_string=consume_js_object(body),headers_obj=consume_js_object(headers),xhr=new XMLHttpRequest;xhr.open(scheme_string,url_string,!0),xhr.responseType="arraybuffer";for(const header in headers_obj)xhr.setRequestHeader(header,headers_obj[header]);return xhr.onload=function(){if(this.status==200){var uInt8Array=new Uint8Array(this.response);ongoing_requests[cid]=uInt8Array}},xhr.onerror=function(e){console.error("Failed to make a request"),console.error(e)},xhr.send(body_string),cid}var Module={onRuntimeInitialized:()=>{shouldRunNow=!1,register_plugins(plugins),wasm_memory=wasmMemory,wasm_exports=Object.fromEntries(Object.entries(Module).filter(([k])=>k[0]=="_"&&k[1]!="_").map(([k,v])=>[k.slice(1),v]));var crate_version=wasm_exports.crate_version();version!=crate_version&&console.error("Version mismatch: gl.js version is: "+version+", rust sapp-wasm crate version is: "+crate_version),init_plugins(plugins),wasm_exports.main()}};
